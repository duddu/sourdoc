name: Build and deploy to web
on:
    workflow_dispatch:
    push:
        branches:
            - main
permissions:
    contents: write
jobs:
    trigger-test:
        uses: ./.github/workflows/test.yml
    build-and-deploy:
        concurrency: deploy-web-${{ github.ref }}
        runs-on: ubuntu-latest
        needs: trigger-test
        steps:
            - uses: ./.github/workflows/build_web.yml
            - uses: JamesIves/github-pages-deploy-action@v4
              with:
                folder: build/web